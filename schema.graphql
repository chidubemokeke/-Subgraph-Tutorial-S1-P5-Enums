# Enum for Transaction Types
# This defines an enumeration called TransactionType.
# Enums are a way to define a set of named values.
# In this case, the values are TRADE, MINT and TRANSFER which represent different types of transactions.
enum TransactionType {
  TRADE # Represents a sale transaction where an NFT is sold
  MINT # Represents a mint transaction where a new NFT is created
  Transfer # Represents when an NFT is transferred without being sold in a marketplace
}

# Define a Transfer entity representing the transfer of NFTs
type Transfer @entity(immutable: true) {
  id: ID! # Unique identifier for the transfer event
  from: Account! # Reference to the Account entity sending the NFT
  to: Account! # Reference to the Account entity receiving the NFT
  tokenId: BigInt! # The unique token ID for the transferred NFT
  value: BigInt! # Value associated with the transfer
  marketPlace: Bytes! # The marketplace or contract address where the transfer took place
  txHash: Bytes! # Transaction hash associated with the transfer
}

# Define an Account entity representing a user account
type Account @entity {
  id: ID! # Unique identifier for the account, typically the address
  sentTransfers: [Transfer!]! @derivedFrom(field: "from") # Array of transfers sent by the account
  receivedTransfers: [Transfer!]! @derivedFrom(field: "to") # Array of transfers received by the account
  totalSpent: BigInt! # Total value of tokens purchased by the account
  sentCount: Int! # Number of transfer events sent by the account
  receivedCount: Int! # Number of transfer events received by the account
  mintCount: Int # Number of tokens minted (if applicable)
}

type Transaction @entity {
  id: ID! # Unique identifier for the transaction
  # Trade/Mint/Transfer
  transactionType: TransactionType!

  # Aggregated data fields for the transaction

  "Total amount sold across all transactions"
  totalSalesVolume: BigInt!
  "Average price of NFTs sold"
  averageSalePrice: BigDecimal!
  "Total number of NFT sales"
  totalSalesCount: BigInt!
  "Highest sale price of an NFT"
  highestSalePrice: BigInt!
  "Lowest sale price of an NFT"
  lowestSalePrice: BigInt!
}
